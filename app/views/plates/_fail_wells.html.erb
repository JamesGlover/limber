<% unless presenter.labware.passed? %>
  <p>Due to a limitation of the current system you can only fail wells <strong>after</strong> passing the plate.</p>
<% else %>
  <%= form_for(:plate, url: fail_wells_path(presenter.labware), html: { method: 'post' }) do |form| %>
    <fieldset><legend class="card-block card-subtitle text-muted">Select wells to fail</legend>
    <%= form.fields_for(:wells) do |well_form| %>
      <%= render partial: 'plate', locals: { plate_presenter: fail_wells_presenter_from(well_form, presenter), id: 'well-failures' } %>
    <% end %>
    </fieldset>
    <div class="card-block">
      <p>NB. Once the "Fail Selected Wells" button has been pressed failures can't be undone but further failed wells can be added. The 'Still charge customer' option will only affect the wells selected for failure at the same time. Previously and subsequently failed wells will retain their original options.</p>
      <%= label_tag :customer_accepts_responsibility, class: 'custom-control custom-checkbox' do %>
        <%= check_box_tag :customer_accepts_responsibility, true, false, class: 'custom-control-input' %>
        <span class="custom-control-indicator"></span>
        <span class="custom-control-description">Still charge customer</span>
      <% end %>
      <%= form.submit('Fail selected wells', class: 'btn btn-lg btn-danger' ) %>
    </div>
  <% end %>
<% end %>
