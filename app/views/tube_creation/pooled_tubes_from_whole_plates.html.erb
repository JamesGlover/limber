<%= page(:'multi-plate-pooling-page') do %>
  <%= content do %>
    <%= render(partial: './search/plate_progress', locals: { plates: @creator_form.available_plates }) %>
  <% end %>
  <%= sidebar do %>
    <%= card title: 'Add plates to pool', without_block: true do %>
      <div id="validation_report"></div>
      <div id="add-plates-instructions-block" class="card-block" >
        <div class="instructions">
          <p>Scan in up to 4 plates.</p>
        </div>
      </div>
      <div class="card-block">
      <%= form_for(
        @creator_form,
        url: limber_plate_tubes_path(@creator_form.parent),
        as: :tube,
        html: { method: :post }) do |form| %>

        <%= form.hidden_field :parent_uuid %>
        <%= form.hidden_field :purpose_uuid %>
        <% 4.times do |i| %>
          <div class="plate-container scan-plate form-group row">
            <label for="tube[barocdes][<%= i %>]" class="plate-label col-2" >Plate <%= i+1 %></label>
            <input id="tube[barocdes][<%= i %>]" name="tube[barcodes][]" class="form-control plate-box col-8" tabindex="1" data-position=<%= i %> />
          </div>
        <% end %>
        <%= form.submit 'Make Pool', class: 'btn btn-success btn-lg', id: 'create-labware' %>
      <% end %>
      </div>
       <ul id="pooling-summary" class="list-group"></ul>
    <% end %>
  <% end %>


<script type="text/javascript">
  (function(window, $, undefined){
    "use strict";

    // Set up the SCAPE namespace
    if (window.SCAPE === undefined) {
      window.SCAPE = {};
    }

    // Extend SCAPE as it could have already been defined in the view.
    // Sequencing Pool ordering relys on Ruby 1.9 hashes being ordered
    $.extend(SCAPE, {
      coloursByLocation: <%= colours_by_location.to_json.html_safe %>,
      plates: new Array(4),
      plate: {},
      sourceStates: ["passed", "qc_complete"]
    });

  })(window, $);
</script>
<% end %>
